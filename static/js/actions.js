
$(document).on("click touch", "#sidebarCollapse", function() {
    $('#sidebar').toggleClass('active');
});

$(window).on('load', function() {

    var fragmentId = location.hash.substr(1);
    if (fragmentId === "pickup" || fragmentId === "pickuphour" || fragmentId === "pickuphour" || fragmentId === "confirmpickup" || fragmentId === "readyforpickup" || fragmentId === "hospitalinfo" || fragmentId === "profile" || fragmentId === "settings" || fragmentId === "calendar") {
        $("#loader").show();
        cookie_value = getCookie("userid");
        if (cookie_value !== "") {
            $.ajax({
                url: '/checklogin',
                dataType: 'json',
                method: 'POST',
                data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
                success: function(res) {
                    if (!res.redirectToLogin) {
                        $("#loader").show();
                        cookie_value = getCookie("userid");
                        if (cookie_value !== "") {
                            $.ajax({
                                url: '/checkpickup',
                                dataType: 'json',
                                method: 'POST',
                                data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
                                success: function(res) {
                                    if (res.redirectToLogin) {
                                        $("#loader").hide();
                                        location.hash = "#login";
                                    } else {
                                        if (res.day_for_pickup) {
                                            $("#loader").hide();
                                            location.hash = "#readyforpickup";
                                        } else {
                                            $("#loader").hide();
                                            location.hash = "#startpickup";
                                        }
                                    }
                                },
                                error: function(error) {
                                    $("#loader").hide();
                                    $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                                    $("#messageModalContent").html(error.responseText)
                                    $("#messageModal").modal("show");
                                }
                            });
                        } else {
                            $("#loader").hide();
                            location.hash = "#login";
                        }
                    } else {
                        // location.hash = "#tutorial";
                        // $.ajax($('.container').load("/tutorial")).done(function() {
                        //     $("#loader").hide();
                        // });
                        $("#loader").hide();
                        location.hash = "#login";
                    }
                    return false;
                }
            });
        } else {
            // location.hash = "#tutorial";
            // $.ajax($('.container').load("/tutorial")).done(function() {
            //     $("#loader").hide();
            // });
            $("#loader").hide();
            location.hash = "#login";
        }
    } else {
        // location.hash = "#tutorial";
        // $.ajax($('.container').load("/tutorial")).done(function() {
        //     $("#loader").hide();
        // });
        $("#loader").hide();
        location.hash = "#login";
    }
});

var rotated1 = false;
var rotated2 = false;
var rotated3 = false;
var username, email, phone, day_for_pickup, hour_for_pickup;

function convertDate(db_entry) {
    var year = db_entry.slice(0, 4);
    var month = db_entry.slice(4, 6);
    if (month === "01") {
        month = "Gennaio"
    }
    else if (month === "02") {
        month = "Febbraio"
    }
    else if (month === "03") {
        month = "Marzo"
    }
    else if (month === "04") {
        month = "Aprile"
    }
    else if (month === "05") {
        month = "Maggio"
    }
    else if (month === "06") {
        month = "Giugno"
    }
    else if (month === "07") {
        month = "Luglio"
    }
    else if (month === "08") {
        month = "Agosto"
    }
    else if (month === "09") {
        month = "Settembre"
    }
    else if (month === "10") {
        month = "Ottobre"
    }
    else if (month ==="11") {
        month = "Novembre"
    }
    else if (month === "12") {
        month = "Dicembre"
    }
    var day = db_entry.slice(6, 8).replace(/\b0+/, '');
    return day + " " + month + " " + year
}

function convertHour(db_entry) {
    return db_entry.slice(0, 2).replace(/\b0+/, '') + ":" + db_entry.slice(2, 4)
}

function getCookie(cookiename) 
  {
  // Get name followed by anything except a semicolon
  var cookiestring=RegExp(cookiename+"=[^;]+").exec(document.cookie);
  // Return everything after the equal sign, or an empty string if the cookie name is not found
  return decodeURIComponent(!!cookiestring ? cookiestring.toString().replace(/^[^=]+./,"") : "");
  }

function getContent(fragmentId, callback){

    var pages = {
        home: "/login",
        login: "/login",
        tutorial: "/tutorial",
        signup: "/signup",
        emailphonesignup: "/emailphonesignup",
        verifyemail: "/verifyemail",
        verifyphone: "/verifyphone",
        success: "/success",
        newpassword: "/newpassword",
        verifyemailforrecovery: "/verifyemailforrecovery",
        verifyphoneforrecovery: "/verifyphoneforrecovery",
        choosenewpassword: "/choosenewpassword",
        recoverysuccess: "/recoverysuccess",
        startpickup: "/startpickup",
        pickup: "/pickup",
        pickuphour: "/pickuphour",
        confirmpickup: "/confirmpickup",
        readyforpickup: "/readyforpickup",
        hospitalinfo: "/hospitalinfo",
        profile: "/profile",
        guide: "/tutorial",
        settings: "/settings",
        calendar: "/calendar",
        pickuphistory: "/pickuphistory",
        notificationhistory: "/notificationhistory"
    };

    callback(pages[fragmentId]);

    if (fragmentId === "verifyemail") {
        $("#email-awaiting-activation").html(email);
    }
    if (fragmentId === "verifyphone") {
        $("#phone-awaiting-activation").html(phone);
    }
    if (fragmentId === "verifyemailforrecovery") {
        $("#email-awaiting-verification").html(email);
    }
    if (fragmentId === "verifyphoneforrecovery") {
        $("#phone-awaiting-verification").html(phone);
    }
    if (fragmentId === "pickuphour") {
        $('#day-for-pickup').html(convertDate(day_for_pickup));
    }
    if (fragmentId === "confirmpickup") {
        $('#day-for-pickup').html(convertDate(day_for_pickup));
        $('#hour-for-pickup').html(convertHour(hour_for_pickup));
    }
    if (fragmentId === "readyforpickup") {
        $("#loader").show();
        cookie_value = getCookie("userid");
        if (cookie_value !== "") {
            $.ajax({
                url: '/checkpickup',
                dataType: 'json',
                method: 'POST',
                data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
                success: function(res) {
                    if (res.redirectToLogin) {
                        location.hash = "#login";
                    } else {
                        if (res.day_for_pickup) {
                            $('#day-for-pickup').html(convertDate(res.day_for_pickup));
                            $('#hour-for-pickup').html(convertHour(res.hour_for_pickup));
                            $('#alert').html("<i class='fas fa-exclamation-circle'></i> Hai 1 terapia da ritirare a breve.");
                        }
                        $("#loader").hide();
                    }
                },
                error: function(error) {
                    $("#loader").hide();
                    $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                    $("#messageModalContent").html(error.responseText)
                    $("#messageModal").modal("show");
                }
            });
        } else {
            location.hash = "#login";
        }
    }
    if (fragmentId === "pickuphistory") {
        $("#loader").show();
        cookie_value = getCookie("userid");
        if (cookie_value !== "") {
            $.ajax({
                url: '/checkpickup',
                dataType: 'json',
                method: 'POST',
                data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
                success: function(res) {
                    if (res.redirectToLogin) {
                        location.hash = "#login";
                    } else {
                        if (res.day_for_pickup) {
                            $("#pickuphistory-container").html(`<a href="#readyforpickup">
                                    <div id="pickupDetails">
                                        <div id="dayhour">
                                            <p class="description"><b>Giorno</b></p>
                                            <p class="description" id="day-for-pickup">`+convertDate(res.day_for_pickup)+`</p>
                                            <p class="description"><b>Ora</b></p>
                                            <p class="description" id="hour-for-pickup">`+convertHour(res.hour_for_pickup)+`</p>
                                        </div>
                                        <svg width="50px" height="50px" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;top: 50%;margin-top: -25px;margin-right: 10px;right: 0;">
                                        <g id="info 1">
                                        <g id="g853">
                                        <g id="g1418">
                                        <path id="path1420" d="M57.141 118.788C49.5344 118.013 43.9696 114.132 41.9668 108.204C40.9923 105.32 41.0772 100.227 42.192 94.6967C42.5039 93.1489 44.1785 86.8729 45.9131 80.75C47.6478 74.6271 49.4515 67.9961 49.9214 66.0145C50.7141 62.6713 50.7756 62.1519 50.775 58.8087C50.7745 55.9249 50.6963 55.0374 50.3836 54.3622C49.3144 52.053 47.5985 51.1681 43.8002 50.967C42.4301 50.8945 40.7992 50.9581 39.8662 51.1206C38.5952 51.342 35.0145 52.3663 33.5582 52.9251C33.4002 52.9857 33.6265 51.6824 34.1201 49.6896L34.9467 46.3526L38.1029 45.14C42.7328 43.3612 47.8881 41.6814 50.5468 41.0852C52.5645 40.6328 53.5123 40.5641 57.5303 40.5792C61.5303 40.5942 62.4388 40.6668 64.0388 41.099C70.0723 42.729 74.2366 46.7927 75.4466 52.2315C75.7722 53.6949 75.8191 54.6869 75.7023 57.6366C75.4747 63.3826 75.3527 63.9519 71.2433 78.4504C66.8147 94.0749 66.2278 96.7014 66.2314 100.881C66.2339 103.769 66.7039 105.369 67.8788 106.489C69.168 107.718 70.5236 108.115 73.9177 108.254C76.4909 108.36 77.1046 108.306 79.283 107.78C80.6358 107.453 82.2877 106.978 82.9537 106.725C84.0425 106.311 84.1528 106.304 84.0457 106.653C83.9801 106.867 83.6116 108.338 83.2267 109.923C82.8418 111.508 82.487 112.845 82.4381 112.894C82.2519 113.08 74.3633 116.067 71.477 117.044C69.815 117.606 67.5661 118.217 66.4794 118.401C63.9298 118.832 59.4139 119.019 57.141 118.788V118.788ZM67.6295 27.3289C63.3301 26.4285 59.1063 23.1566 57.4059 19.4092C56.5828 17.5954 56.2518 15.9727 56.2518 13.7517C56.2518 10.0989 57.4405 7.39611 60.3111 4.52179C63.4813 1.34751 66.442 0.156532 71.1283 0.170423C73.37 0.177068 74.1097 0.27773 75.7109 0.794014C82.5434 2.99707 86.773 9.70511 85.477 16.2831C84.9651 18.8819 83.9444 20.8639 82.1252 22.7924C79.1376 25.9594 75.8966 27.4296 71.5956 27.5688C70.108 27.617 68.5569 27.5232 67.6295 27.3289V27.3289Z" fill="white"/>
                                        </g>
                                        </g>
                                        </g>
                                        </svg>
                                    </div>
                                </a>`);
                            $('#alert').html("<i class='fas fa-exclamation-circle'></i> Hai 1 terapia da ritirare a breve.");
                        } else {
                            $("#pickuphistory-container").html("<p><b>Cronologia vuota</b></p>")
                        }
                        $("#loader").hide();
                    }
                },
                error: function(error) {
                    $("#loader").hide();
                    $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                    $("#messageModalContent").html(error.responseText)
                    $("#messageModal").modal("show");
                }
            });
        } else {
            location.hash = "#login";
        }
    }
    if (fragmentId === "notificationhistory") {
        $("#loader").show();
        cookie_value = getCookie("userid");
        if (cookie_value !== "") {
            $.ajax({
                url: '/checkpickup',
                dataType: 'json',
                method: 'POST',
                data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
                success: function(res) {
                    if (res.redirectToLogin) {
                        location.hash = "#login";
                    } else {
                        if (res.day_for_pickup && !res.successful_pickup_order_notification_removed) {
                            $("#notificationhistory-container").html(`<div class="mdc-card">
                                                                          <div class="mdc-card__primary-action">
                                                                            <p>La prenotazione del ritiro Ã¨ andata a buon fine.</p>
                                                                          </div>
                                                                            <div class="mdc-card__action-icons">
                                                                              <button class="material-icons mdc-icon-button mdc-icon-button-close mdc-card__action mdc-card__action--icon" title="Close"><i class="fas fa-times"></i></button>
                                                                            </div>
                                                                          </div>
                                                                        </div>`);
                            $(document).on("click touch", ".mdc-icon-button-close", function() {
                                var remove_notification_button = $(this);
                                $("#loader").show();
                                $.ajax({
                                    url: '/notificationhistory',
                                    dataType: 'json',
                                    method: 'POST',
                                    data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1], successful_pickup_order_notification_removed: 1},
                                    success: function(res) {
                                        $("#loader").hide();
                                        if (!res.redirectToLogin) {
                                            remove_notification_button.parent().parent().remove();
                                            if ($("#notificationhistory-container").children().length === 0) {
                                                $("#notificationhistory-container").html(`<svg width="50vw" viewBox="0 0 264 264" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                                            <g id="zero-bell 1">
                                                                                            <g id="g841">
                                                                                            <g id="g845">
                                                                                            <path id="path853" d="M130.992 253.087C129.163 251.85 126.092 249.168 124.167 247.126C121.1 243.873 120.667 243.069 120.667 240.64C120.667 238.375 121.082 237.451 122.933 235.6L125.2 233.333H143.933C158.479 233.333 162.665 233.52 162.66 234.167C162.648 235.862 158.586 242.017 155.335 245.268C151.482 249.122 147.622 251.542 142.555 253.284C135.821 255.599 134.68 255.58 130.992 253.087V253.087ZM101.283 250.833L99.6667 249L101.5 250.616C103.214 252.127 103.639 252.667 103.116 252.667C102.997 252.667 102.172 251.842 101.283 250.833V250.833ZM73.7502 214.584C70.5656 210.863 69.1126 206.295 69.4631 201.106C69.7713 196.543 71.0068 193.509 74.0686 189.794L76.1189 187.307L154.893 187.487C230.327 187.659 233.766 187.719 236 188.911C241.574 191.884 244.227 196.213 244.227 202.333C244.227 208.454 241.574 212.782 236 215.755C233.766 216.947 230.33 217.008 154.894 217.177L76.1221 217.355L73.7502 214.584ZM14.6667 188.415C14.6667 188.277 15.1917 187.752 15.8333 187.248C16.8907 186.419 16.9143 186.443 16.085 187.5C15.2141 188.61 14.6667 188.964 14.6667 188.415ZM104.468 169.705C98.4544 167.56 93.6975 162.594 91.8953 156.58C90.8076 152.95 91.5934 94.4286 92.8974 81.9516C94.8023 63.7245 97.2235 53.5262 101.987 43.6667C106.015 35.3288 111.042 29.5264 115 28.6475C120.249 27.482 133.583 27.1602 142.333 27.9881C161.175 29.7706 174.622 35.2464 184.367 45.1046C188.235 49.0168 193.419 56.3651 194.291 59.1703C194.98 61.3847 197.946 64.6667 199.259 64.6667C199.887 64.6667 200.778 64.2917 201.24 63.8333C201.912 63.1657 202.001 63.2047 201.687 64.0297C201.472 64.596 201.739 66.3148 202.28 67.8492C203.082 70.1207 203.103 70.7344 202.396 71.1528C200.321 72.3811 200.114 74.2215 201.325 80.6667C201.98 84.15 202.722 88.5367 202.975 90.4149L203.435 93.8298L198.952 94.6756C181.661 97.9382 169.717 114.266 172.547 130.771C174.766 143.71 184.45 153.922 197.395 156.973C199.745 157.527 202.642 157.985 203.833 157.99C205.744 157.999 206.003 158.216 206.024 159.833C206.037 160.842 206.482 163.467 207.013 165.667C207.545 167.867 207.984 169.892 207.99 170.167C207.996 170.442 185.275 170.653 157.5 170.637C116.769 170.614 106.51 170.433 104.468 169.705V169.705ZM50.2329 115.333C50.2329 112.217 50.3478 110.942 50.4881 112.5C50.6285 114.058 50.6285 116.608 50.4881 118.167C50.3478 119.725 50.2329 118.45 50.2329 115.333V115.333ZM50.7193 98.2778C50.7513 97.5011 50.9093 97.3432 51.1221 97.875C51.3147 98.3562 51.291 98.9312 51.0695 99.1528C50.8479 99.3743 50.6904 98.9806 50.7193 98.2778ZM32.7719 82.6667C32.7719 81.75 32.9233 81.375 33.1082 81.8333C33.2931 82.2917 33.2931 83.0417 33.1082 83.5C32.9233 83.9583 32.7719 83.5833 32.7719 82.6667V82.6667ZM221.515 79.3333C221.515 77.6833 221.645 77.0083 221.804 77.8333C221.963 78.6583 221.963 80.0083 221.804 80.8333C221.645 81.6583 221.515 80.9833 221.515 79.3333ZM229.439 79.3333C229.439 78.4167 229.59 78.0417 229.775 78.5C229.96 78.9583 229.96 79.7083 229.775 80.1667C229.59 80.625 229.439 80.25 229.439 79.3333V79.3333ZM41.386 72.9445C41.418 72.1678 41.5759 72.0098 41.7887 72.5417C41.9813 73.0229 41.9576 73.5979 41.7361 73.8195C41.5146 74.041 41.357 73.6472 41.386 72.9445H41.386ZM246.772 60.6667C246.772 59.75 246.923 59.375 247.108 59.8333C247.293 60.2917 247.293 61.0417 247.108 61.5C246.923 61.9583 246.772 61.5833 246.772 60.6667V60.6667ZM238.797 58.3333C238.81 57.2333 238.96 56.864 239.129 57.5127C239.298 58.1613 239.287 59.0613 239.104 59.5127C238.921 59.964 238.783 59.4333 238.797 58.3333H238.797ZM191.248 40.8333C190.419 39.776 190.443 39.7524 191.5 40.5816C192.142 41.0849 192.667 41.6099 192.667 41.7483C192.667 42.297 192.119 41.9438 191.248 40.8333ZM187.915 37.5C187.086 36.4426 187.109 36.4191 188.167 37.2483C189.277 38.1192 189.63 38.6667 189.082 38.6667C188.943 38.6667 188.418 38.1417 187.915 37.5V37.5ZM232.291 23.1667L230.333 21L232.5 22.9581C233.692 24.035 234.667 25.01 234.667 25.1247C234.667 25.6398 234.117 25.1863 232.291 23.1667Z" fill="#F5D15E"/>
                                                                                            <path id="path851" d="M121.333 253.816C115.34 251.765 110.943 249.049 106.854 244.872C103.033 240.966 99.0206 233.443 98.0827 228.423L97.5055 225.333H131.419C150.072 225.333 165.332 225.558 165.331 225.833C165.326 226.822 162.767 234.981 162.718 234.167C162.678 233.521 158.448 233.333 143.933 233.333H125.2L122.933 235.6C121.082 237.451 120.667 238.375 120.667 240.64C120.667 243.069 121.1 243.873 124.167 247.126C126.092 249.168 129.163 251.85 130.991 253.086L134.316 255.333L129.991 255.316C127.306 255.305 124.024 254.737 121.333 253.816ZM136.542 254.878C137.023 254.685 137.598 254.709 137.819 254.931C138.041 255.152 137.647 255.31 136.944 255.281C136.168 255.249 136.01 255.091 136.542 254.878ZM152 248.415C152 248.277 152.525 247.752 153.167 247.248C154.224 246.419 154.248 246.443 153.418 247.5C152.547 248.61 152 248.964 152 248.415ZM156.667 243.748C156.667 243.61 157.192 243.085 157.833 242.582C158.891 241.752 158.914 241.776 158.085 242.833C157.214 243.944 156.667 244.297 156.667 243.748ZM62 220.693C62 220.34 61.3434 219.44 60.541 218.693C59.165 217.411 58.2532 217.333 44.5196 217.333C28.818 217.333 27.5352 217.111 23.4708 213.684C16.5216 207.824 16.6894 196.594 23.814 190.717C25.1996 189.574 27.3833 188.347 28.6667 187.99C29.9673 187.628 40.9536 187.339 53.4898 187.337L75.9795 187.333L73.4103 190.728C70.4334 194.661 69.3333 197.826 69.3333 202.458C69.3333 206.92 70.9225 211.28 73.7548 214.589C76.0334 217.251 76.0568 217.333 74.5336 217.333C72.5971 217.333 70 219.073 70 220.371C70 221.102 69.0413 221.333 66 221.333C63.8 221.333 62 221.045 62 220.693ZM244.053 204.944C244.085 204.168 244.243 204.01 244.455 204.542C244.648 205.023 244.624 205.598 244.403 205.819C244.181 206.041 244.024 205.647 244.053 204.944ZM244.053 199.611C244.085 198.834 244.243 198.677 244.455 199.208C244.648 199.69 244.624 200.265 244.403 200.486C244.181 200.708 244.024 200.314 244.053 199.611ZM231.875 187.545C232.356 187.352 232.931 187.376 233.153 187.597C233.374 187.819 232.981 187.976 232.278 187.947C231.501 187.915 231.343 187.757 231.875 187.545ZM51.6978 176.5C56.307 168.441 57.2714 161.114 57.9941 128.667C58.9073 87.6662 60.628 75.8671 67.9596 60.3333C74.3047 46.8897 83.6914 38.1804 97.6667 32.7701C102.107 31.0509 110.761 28.6667 112.559 28.6667C112.821 28.6667 111.292 30.4987 109.161 32.7379C104.673 37.455 99.5703 47.2935 97.4429 55.3333C93.0981 71.7527 91.9534 84.9285 91.5268 123.434C91.5268 123.434 92 153.5 92 155.5C92 157.5 92.8142 158.767 92.8142 158.767C95.0311 163.59 97.5 165.5 101.445 168.364C101.445 168.364 104 169.5 105 169.5C106 169.5 156.833 170.333 156.833 170.333C195.411 170.333 208.667 170.529 208.667 171.099C208.667 171.52 209.551 173.545 210.631 175.599L212.595 179.333H131.336H50.0773L51.6978 176.5ZM206.053 161.611C206.085 160.834 206.243 160.677 206.455 161.208C206.648 161.69 206.624 162.265 206.403 162.486C206.181 162.708 206.024 162.314 206.053 161.611ZM202.719 89.6111C202.751 88.8345 202.909 88.6765 203.122 89.2083C203.315 89.6896 203.291 90.2646 203.069 90.4861C202.848 90.7076 202.69 90.3139 202.719 89.6111ZM198.5 64.2251C198.958 64.0402 199.708 64.0402 200.167 64.2251C200.625 64.4101 200.25 64.5614 199.333 64.5614C198.417 64.5614 198.042 64.4101 198.5 64.2251ZM186.27 47.1667L185 45.6667L186.5 46.9367C187.91 48.1301 188.303 48.6667 187.77 48.6667C187.643 48.6667 186.968 47.9917 186.27 47.1667ZM181.248 42.1667C180.419 41.1093 180.443 41.0857 181.5 41.915C182.61 42.7859 182.964 43.3333 182.415 43.3333C182.277 43.3333 181.752 42.8083 181.248 42.1667ZM114.5 28.2251C114.958 28.0402 115.708 28.0402 116.167 28.2251C116.625 28.4101 116.25 28.5614 115.333 28.5614C114.417 28.5614 114.042 28.4101 114.5 28.2251ZM146.5 28.2251C146.958 28.0402 147.708 28.0402 148.167 28.2251C148.625 28.4101 148.25 28.5614 147.333 28.5614C146.417 28.5614 146.042 28.4101 146.5 28.2251ZM121.513 27.538C122.161 27.369 123.061 27.3801 123.513 27.5627C123.964 27.7453 123.433 27.8836 122.333 27.87C121.233 27.8564 120.864 27.707 121.513 27.538ZM139.513 27.538C140.161 27.369 141.061 27.3801 141.513 27.5627C141.964 27.7453 141.433 27.8836 140.333 27.87C139.233 27.8564 138.864 27.707 139.513 27.538ZM116.667 19.1401C116.667 17.7395 119.514 13.2991 121.471 11.6495C124.578 9.02946 127.419 7.99776 131.479 8.01464C137.519 8.03975 143.287 11.8538 145.572 17.3333L146.545 19.6667H131.606C123.389 19.6667 116.667 19.4297 116.667 19.1401Z" fill="#E48D12"/>
                                                                                            <path id="path849" d="M160.667 251C161.528 250.083 162.382 249.333 162.566 249.333C162.749 249.333 162.194 250.083 161.333 251C160.472 251.917 159.618 252.667 159.434 252.667C159.251 252.667 159.806 251.917 160.667 251ZM10.0526 202.278C10.0846 201.501 10.2426 201.343 10.4554 201.875C10.648 202.356 10.6243 202.931 10.4028 203.153C10.1813 203.374 10.0237 202.981 10.0526 202.278V202.278ZM30.5417 179.545C31.0229 179.352 31.5979 179.376 31.8195 179.597C32.041 179.819 31.6472 179.976 30.9445 179.947C30.1678 179.915 30.0099 179.757 30.5417 179.545V179.545ZM197.089 156.977C180.714 152.867 169.838 137.026 172.547 121.229C174.766 108.29 184.45 98.0779 197.395 95.0265C219.804 89.7445 241.213 108.848 237.453 130.771C235.648 141.3 229.336 149.646 219.572 154.414C216.691 155.821 214.183 157.129 214 157.32C213.202 158.15 200.758 157.898 197.089 156.977V156.977ZM211.722 141.965C213.121 141.101 214.616 139.206 215.786 136.816C217.398 133.521 217.636 132.248 217.636 126.94C217.636 121.487 217.428 120.442 215.652 116.995C211.26 108.471 202.264 108.475 198 117.002C196.54 119.921 196.333 121.2 196.333 127.334C196.333 133.229 196.56 134.755 197.768 137.001C199.254 139.761 201.596 142.228 203.333 142.863C205.618 143.698 209.611 143.271 211.722 141.966V141.965ZM203.683 138.41C201.413 136.141 200.48 131.9 200.794 125.291C201.104 118.764 202.541 115.486 205.527 114.491C207.966 113.678 210.421 115.262 211.818 118.552C213.106 121.586 213.262 131.32 212.078 134.823C211.156 137.553 208.541 140 206.546 140C205.846 140 204.557 139.284 203.683 138.41V138.41ZM50.2521 128C50.2521 123.783 50.3604 122.058 50.4927 124.167C50.625 126.275 50.625 129.725 50.4927 131.833C50.3604 133.942 50.2521 132.217 50.2521 128V128ZM50.7193 100.278C50.7513 99.5011 50.9093 99.3432 51.1221 99.875C51.3147 100.356 51.291 100.931 51.0695 101.153C50.8479 101.374 50.6904 100.981 50.7193 100.278ZM229.463 82.3333C229.477 81.2333 229.626 80.864 229.795 81.5127C229.964 82.1613 229.953 83.0613 229.771 83.5127C229.588 83.964 229.45 83.4333 229.463 82.3333V82.3333ZM40.8348 81C40.8422 79.5333 40.9787 79.0118 41.1382 79.8411C41.2976 80.6704 41.2916 81.8704 41.1247 82.5078C40.9579 83.1452 40.8274 82.4667 40.8348 81ZM221.386 75.6111C221.418 74.8345 221.576 74.6765 221.789 75.2083C221.981 75.6896 221.958 76.2646 221.736 76.4861C221.515 76.7076 221.357 76.3139 221.386 75.6111H221.386ZM41.386 70.9445C41.418 70.1678 41.5759 70.0098 41.7887 70.5417C41.9813 71.0229 41.9576 71.5979 41.7361 71.8195C41.5146 72.041 41.357 71.6472 41.386 70.9445H41.386ZM203.875 70.8779C204.356 70.6853 204.931 70.709 205.153 70.9305C205.374 71.152 204.981 71.3096 204.278 71.2807C203.501 71.2487 203.343 71.0907 203.875 70.8779V70.8779ZM228.053 66.9444C228.085 66.1678 228.243 66.0098 228.455 66.5417C228.648 67.0229 228.624 67.5979 228.403 67.8194C228.181 68.041 228.024 67.6472 228.053 66.9444H228.053ZM23.5015 59C23.5089 57.5333 23.6454 57.0118 23.8048 57.8411C23.9643 58.6704 23.9583 59.8704 23.7914 60.5078C23.6245 61.1452 23.4941 60.4667 23.5015 59ZM246.053 52.9444C246.085 52.1678 246.243 52.0098 246.455 52.5417C246.648 53.0229 246.624 53.5979 246.403 53.8194C246.181 54.041 246.024 53.6472 246.053 52.9444H246.053ZM202.582 31.5C201.752 30.4426 201.776 30.419 202.833 31.2483C203.944 32.1192 204.297 32.6667 203.748 32.6667C203.61 32.6667 203.085 32.1417 202.582 31.5V31.5ZM33.3333 31.0816C33.3333 30.9432 33.8583 30.4182 34.5 29.915C35.5574 29.0857 35.581 29.1093 34.7517 30.1667C33.8808 31.2772 33.3333 31.6303 33.3333 31.0816V31.0816ZM52.6667 27.7914C52.6667 27.6767 53.6417 26.7017 54.8333 25.6247L57 23.6667L55.0419 25.8333C53.2168 27.853 52.6667 28.3064 52.6667 27.7914V27.7914ZM205.248 23.5C204.419 22.4426 204.443 22.419 205.5 23.2483C206.61 24.1192 206.964 24.6667 206.415 24.6667C206.277 24.6667 205.752 24.1417 205.248 23.5ZM36.5417 18.8779C37.0229 18.6853 37.5979 18.709 37.8195 18.9306C38.041 19.1521 37.6472 19.3096 36.9445 19.2807C36.1678 19.2487 36.0099 19.0907 36.5417 18.8779V18.8779ZM225.208 18.8779C225.69 18.6853 226.265 18.709 226.486 18.9306C226.708 19.1521 226.314 19.3096 225.611 19.2807C224.834 19.2487 224.677 19.0907 225.208 18.8779V18.8779ZM115 6.66666C115.664 5.93333 116.357 5.33333 116.54 5.33333C116.723 5.33333 116.33 5.93333 115.667 6.66666C115.003 7.4 114.31 8 114.127 8C113.943 8 114.336 7.4 115 6.66666ZM128.542 0.211255C129.023 0.0186742 129.598 0.0423584 129.819 0.263886C130.041 0.485414 129.647 0.64298 128.944 0.614032C128.168 0.582043 128.01 0.424072 128.542 0.211255V0.211255Z" fill="#1155AD"/>
                                                                                            <path id="path847" d="M123.52 262.34C111.288 260.122 99.6641 251.263 94.2057 240C92.6953 236.883 91.0761 232.308 90.6075 229.833L89.7554 225.333H81.3594C71.8449 225.333 70 224.684 70 221.333C70 217.085 64.8286 217.335 152.982 217.319C229.17 217.305 233.128 217.245 235.667 216.081C245.517 211.562 247.704 198.924 239.915 191.534C235.158 187.021 243.202 187.333 131.855 187.337C68.4761 187.339 30.133 187.582 28.6667 187.99C27.3833 188.347 25.1996 189.574 23.814 190.717C16.6894 196.594 16.5216 207.824 23.4708 213.684C27.5352 217.111 28.818 217.333 44.5196 217.333C58.2532 217.333 59.165 217.411 60.541 218.693C62.4265 220.449 62.383 221.678 60.3636 223.697C58.7387 225.322 58.6371 225.333 45.788 225.333C38.6713 225.333 31.2648 225.033 29.3291 224.666C18.573 222.626 11.3231 214.283 10.7924 203.333C10.177 190.637 19.1695 180.912 32.7009 179.64C40.6289 178.894 44.0545 176.237 46.8446 168.667C49.2665 162.096 49.9106 154.123 50.6686 121.333C51.1462 100.674 51.5653 93.1327 52.6139 86.3333C58.1968 50.133 73.3247 31.0853 102.904 23.0122L108.259 21.551L109.012 18.2755C110.526 11.691 115.159 5.72521 121.036 2.78937C127.347 -0.36259 136.039 -0.362524 142.086 2.78953C147.56 5.64254 154 14.1735 154 18.5709C154 20.7542 154.739 22 156.033 22C158.735 22 171.957 26.894 177.188 29.8302C180.289 31.5708 185.094 35.1274 188.034 37.8591C194.724 44.0738 203.333 56.8357 203.333 60.5368C203.333 62.4263 201.069 64.1325 198.893 63.8833C197.292 63.7001 196.579 62.8786 194.262 58.5526C190.796 52.0795 187.593 47.7127 183.533 43.9273C170.56 31.8328 152.382 26.6142 126.365 27.5157C84.298 28.9732 63.968 49.3335 59.3141 94.6667C58.9188 98.5167 58.3248 113.817 57.9941 128.667C57.2714 161.114 56.307 168.441 51.6978 176.5L50.0773 179.333H131.4H212.723L211.068 176.5C209.424 173.687 207.152 166.202 206.333 160.902L205.906 158.138L209.256 157.677C211.098 157.424 212.884 157.389 213.225 157.6C213.565 157.81 214.06 159.706 214.323 161.813C215.379 170.267 219.708 177.363 224.573 178.614C225.908 178.958 229.171 179.531 231.823 179.888C237.749 180.687 241.82 182.59 245.513 186.29C258.615 199.414 251.736 221.177 233.386 224.657C231.321 225.048 217.812 225.333 201.328 225.333H172.838L172.389 228.723C171.01 239.114 163.8 249.936 154 256.32C148.71 259.767 143.86 261.615 137.539 262.592C131.691 263.496 129.698 263.46 123.52 262.34V262.34ZM141.478 254.01C149.26 251.606 156.757 245.633 160.93 238.512C162.432 235.95 165.333 227.596 165.333 225.835C165.333 225.559 150.072 225.333 131.419 225.333H97.5055L98.0827 228.423C99.0206 233.443 103.033 240.966 106.854 244.872C115.853 254.066 129.572 257.687 141.478 254.01V254.01ZM145.572 17.3333C143.287 11.8538 137.519 8.03976 131.479 8.01465C127.419 7.99777 124.578 9.02947 121.471 11.6495C119.514 13.2991 116.667 17.7395 116.667 19.1401C116.667 19.4297 123.389 19.6667 131.606 19.6667H146.545L145.572 17.3333ZM206.5 94.1767C203.759 93.9605 203.334 93.7302 203.335 92.4635C203.336 91.6586 202.673 87.0576 201.86 82.2391C200.156 72.1286 200.414 71.1146 204.61 71.4663C206.737 71.6447 207.094 71.9537 207.853 74.278C208.653 76.7309 210.04 84.3337 210.994 91.5C211.314 93.91 211.206 94.638 210.541 94.5465C210.06 94.4804 208.242 94.314 206.5 94.1767V94.1767ZM34.4367 86.1142C31.0896 82.4157 35.6565 56.6043 41.829 44.3333C48.34 31.3895 62.8024 16.3863 67.6064 17.592C69.6107 18.095 70.9045 20.2004 70.3272 22.0194C70.0999 22.7357 68.1689 24.6644 66.0361 26.3055C51.2864 37.6552 42.4555 55.8946 41.0074 78C40.5178 85.4738 39.7194 87.3333 37 87.3333C36.197 87.3333 35.0435 86.7847 34.4367 86.1142ZM223.191 86.1667C222.485 85.3559 222.058 82.8649 221.791 78C220.562 55.6268 210.709 35.8569 195.5 25.246C193.28 23.6971 192.667 22.8537 192.667 21.3489C192.667 19.1876 194.175 17.3333 195.933 17.3333C199.273 17.3333 210.434 27.4594 215.498 35.0848C224.046 47.955 228.38 61.3796 229.147 77.3607C229.468 84.0447 229.367 85.2043 228.377 86.194C226.908 87.6638 224.483 87.651 223.191 86.1666V86.1667ZM18.2931 64.4876C17.5819 64.0987 16.758 63.455 16.4622 63.057C15.6034 61.9016 16.5831 51.237 18.0691 45.5634C22.0461 30.3795 35.0001 15.2668 39.8667 20.1333C41.6796 21.9463 40.7143 24.1087 36.0657 28.648C28.7879 35.7545 24.6587 45.5176 23.5818 58.1644C23.3399 61.0049 22.8101 63.5833 22.4043 63.8943C20.9813 64.985 19.5744 65.1881 18.2931 64.4876V64.4876ZM241.626 64.4876C239.73 63.4507 239.355 62.641 239.344 59.5586C239.33 55.9276 237.65 47.2285 236.219 43.3792C234.113 37.7168 231.071 33.0195 226.526 28.4122C224.037 25.8889 222 23.3942 222 22.8684C222 20.63 223.376 19.3333 225.752 19.3333C230.591 19.3333 240.121 31.3869 243.74 42.0855C246.448 50.0902 247.636 62.42 245.833 63.8149C244.323 64.9832 242.938 65.2047 241.626 64.4876V64.4876Z" fill="#050403"/>
                                                                                            </g>
                                                                                            </g>
                                                                                            </g>
                                                                                            </svg>
                                                                                        <p><b>Nessuna notifica</b></p>`);
                                            }
                                        } else {
                                            location.hash = "#login"
                                        }
                                    },
                                    error: function(error) {
                                        $("#loader").hide();
                                        $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                                        $("#messageModalContent").html(error.responseText)
                                        $("#messageModal").modal("show");
                                    }
                                });
                            });
                            $('#alert').html("<i class='fas fa-exclamation-circle'></i> Hai 1 terapia da ritirare a breve.");
                        } else {
                            $("#notificationhistory-container").html(`<svg width="50vw" viewBox="0 0 264 264" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                        <g id="zero-bell 1">
                                                                        <g id="g841">
                                                                        <g id="g845">
                                                                        <path id="path853" d="M130.992 253.087C129.163 251.85 126.092 249.168 124.167 247.126C121.1 243.873 120.667 243.069 120.667 240.64C120.667 238.375 121.082 237.451 122.933 235.6L125.2 233.333H143.933C158.479 233.333 162.665 233.52 162.66 234.167C162.648 235.862 158.586 242.017 155.335 245.268C151.482 249.122 147.622 251.542 142.555 253.284C135.821 255.599 134.68 255.58 130.992 253.087V253.087ZM101.283 250.833L99.6667 249L101.5 250.616C103.214 252.127 103.639 252.667 103.116 252.667C102.997 252.667 102.172 251.842 101.283 250.833V250.833ZM73.7502 214.584C70.5656 210.863 69.1126 206.295 69.4631 201.106C69.7713 196.543 71.0068 193.509 74.0686 189.794L76.1189 187.307L154.893 187.487C230.327 187.659 233.766 187.719 236 188.911C241.574 191.884 244.227 196.213 244.227 202.333C244.227 208.454 241.574 212.782 236 215.755C233.766 216.947 230.33 217.008 154.894 217.177L76.1221 217.355L73.7502 214.584ZM14.6667 188.415C14.6667 188.277 15.1917 187.752 15.8333 187.248C16.8907 186.419 16.9143 186.443 16.085 187.5C15.2141 188.61 14.6667 188.964 14.6667 188.415ZM104.468 169.705C98.4544 167.56 93.6975 162.594 91.8953 156.58C90.8076 152.95 91.5934 94.4286 92.8974 81.9516C94.8023 63.7245 97.2235 53.5262 101.987 43.6667C106.015 35.3288 111.042 29.5264 115 28.6475C120.249 27.482 133.583 27.1602 142.333 27.9881C161.175 29.7706 174.622 35.2464 184.367 45.1046C188.235 49.0168 193.419 56.3651 194.291 59.1703C194.98 61.3847 197.946 64.6667 199.259 64.6667C199.887 64.6667 200.778 64.2917 201.24 63.8333C201.912 63.1657 202.001 63.2047 201.687 64.0297C201.472 64.596 201.739 66.3148 202.28 67.8492C203.082 70.1207 203.103 70.7344 202.396 71.1528C200.321 72.3811 200.114 74.2215 201.325 80.6667C201.98 84.15 202.722 88.5367 202.975 90.4149L203.435 93.8298L198.952 94.6756C181.661 97.9382 169.717 114.266 172.547 130.771C174.766 143.71 184.45 153.922 197.395 156.973C199.745 157.527 202.642 157.985 203.833 157.99C205.744 157.999 206.003 158.216 206.024 159.833C206.037 160.842 206.482 163.467 207.013 165.667C207.545 167.867 207.984 169.892 207.99 170.167C207.996 170.442 185.275 170.653 157.5 170.637C116.769 170.614 106.51 170.433 104.468 169.705V169.705ZM50.2329 115.333C50.2329 112.217 50.3478 110.942 50.4881 112.5C50.6285 114.058 50.6285 116.608 50.4881 118.167C50.3478 119.725 50.2329 118.45 50.2329 115.333V115.333ZM50.7193 98.2778C50.7513 97.5011 50.9093 97.3432 51.1221 97.875C51.3147 98.3562 51.291 98.9312 51.0695 99.1528C50.8479 99.3743 50.6904 98.9806 50.7193 98.2778ZM32.7719 82.6667C32.7719 81.75 32.9233 81.375 33.1082 81.8333C33.2931 82.2917 33.2931 83.0417 33.1082 83.5C32.9233 83.9583 32.7719 83.5833 32.7719 82.6667V82.6667ZM221.515 79.3333C221.515 77.6833 221.645 77.0083 221.804 77.8333C221.963 78.6583 221.963 80.0083 221.804 80.8333C221.645 81.6583 221.515 80.9833 221.515 79.3333ZM229.439 79.3333C229.439 78.4167 229.59 78.0417 229.775 78.5C229.96 78.9583 229.96 79.7083 229.775 80.1667C229.59 80.625 229.439 80.25 229.439 79.3333V79.3333ZM41.386 72.9445C41.418 72.1678 41.5759 72.0098 41.7887 72.5417C41.9813 73.0229 41.9576 73.5979 41.7361 73.8195C41.5146 74.041 41.357 73.6472 41.386 72.9445H41.386ZM246.772 60.6667C246.772 59.75 246.923 59.375 247.108 59.8333C247.293 60.2917 247.293 61.0417 247.108 61.5C246.923 61.9583 246.772 61.5833 246.772 60.6667V60.6667ZM238.797 58.3333C238.81 57.2333 238.96 56.864 239.129 57.5127C239.298 58.1613 239.287 59.0613 239.104 59.5127C238.921 59.964 238.783 59.4333 238.797 58.3333H238.797ZM191.248 40.8333C190.419 39.776 190.443 39.7524 191.5 40.5816C192.142 41.0849 192.667 41.6099 192.667 41.7483C192.667 42.297 192.119 41.9438 191.248 40.8333ZM187.915 37.5C187.086 36.4426 187.109 36.4191 188.167 37.2483C189.277 38.1192 189.63 38.6667 189.082 38.6667C188.943 38.6667 188.418 38.1417 187.915 37.5V37.5ZM232.291 23.1667L230.333 21L232.5 22.9581C233.692 24.035 234.667 25.01 234.667 25.1247C234.667 25.6398 234.117 25.1863 232.291 23.1667Z" fill="#F5D15E"/>
                                                                        <path id="path851" d="M121.333 253.816C115.34 251.765 110.943 249.049 106.854 244.872C103.033 240.966 99.0206 233.443 98.0827 228.423L97.5055 225.333H131.419C150.072 225.333 165.332 225.558 165.331 225.833C165.326 226.822 162.767 234.981 162.718 234.167C162.678 233.521 158.448 233.333 143.933 233.333H125.2L122.933 235.6C121.082 237.451 120.667 238.375 120.667 240.64C120.667 243.069 121.1 243.873 124.167 247.126C126.092 249.168 129.163 251.85 130.991 253.086L134.316 255.333L129.991 255.316C127.306 255.305 124.024 254.737 121.333 253.816ZM136.542 254.878C137.023 254.685 137.598 254.709 137.819 254.931C138.041 255.152 137.647 255.31 136.944 255.281C136.168 255.249 136.01 255.091 136.542 254.878ZM152 248.415C152 248.277 152.525 247.752 153.167 247.248C154.224 246.419 154.248 246.443 153.418 247.5C152.547 248.61 152 248.964 152 248.415ZM156.667 243.748C156.667 243.61 157.192 243.085 157.833 242.582C158.891 241.752 158.914 241.776 158.085 242.833C157.214 243.944 156.667 244.297 156.667 243.748ZM62 220.693C62 220.34 61.3434 219.44 60.541 218.693C59.165 217.411 58.2532 217.333 44.5196 217.333C28.818 217.333 27.5352 217.111 23.4708 213.684C16.5216 207.824 16.6894 196.594 23.814 190.717C25.1996 189.574 27.3833 188.347 28.6667 187.99C29.9673 187.628 40.9536 187.339 53.4898 187.337L75.9795 187.333L73.4103 190.728C70.4334 194.661 69.3333 197.826 69.3333 202.458C69.3333 206.92 70.9225 211.28 73.7548 214.589C76.0334 217.251 76.0568 217.333 74.5336 217.333C72.5971 217.333 70 219.073 70 220.371C70 221.102 69.0413 221.333 66 221.333C63.8 221.333 62 221.045 62 220.693ZM244.053 204.944C244.085 204.168 244.243 204.01 244.455 204.542C244.648 205.023 244.624 205.598 244.403 205.819C244.181 206.041 244.024 205.647 244.053 204.944ZM244.053 199.611C244.085 198.834 244.243 198.677 244.455 199.208C244.648 199.69 244.624 200.265 244.403 200.486C244.181 200.708 244.024 200.314 244.053 199.611ZM231.875 187.545C232.356 187.352 232.931 187.376 233.153 187.597C233.374 187.819 232.981 187.976 232.278 187.947C231.501 187.915 231.343 187.757 231.875 187.545ZM51.6978 176.5C56.307 168.441 57.2714 161.114 57.9941 128.667C58.9073 87.6662 60.628 75.8671 67.9596 60.3333C74.3047 46.8897 83.6914 38.1804 97.6667 32.7701C102.107 31.0509 110.761 28.6667 112.559 28.6667C112.821 28.6667 111.292 30.4987 109.161 32.7379C104.673 37.455 99.5703 47.2935 97.4429 55.3333C93.0981 71.7527 91.9534 84.9285 91.5268 123.434C91.5268 123.434 92 153.5 92 155.5C92 157.5 92.8142 158.767 92.8142 158.767C95.0311 163.59 97.5 165.5 101.445 168.364C101.445 168.364 104 169.5 105 169.5C106 169.5 156.833 170.333 156.833 170.333C195.411 170.333 208.667 170.529 208.667 171.099C208.667 171.52 209.551 173.545 210.631 175.599L212.595 179.333H131.336H50.0773L51.6978 176.5ZM206.053 161.611C206.085 160.834 206.243 160.677 206.455 161.208C206.648 161.69 206.624 162.265 206.403 162.486C206.181 162.708 206.024 162.314 206.053 161.611ZM202.719 89.6111C202.751 88.8345 202.909 88.6765 203.122 89.2083C203.315 89.6896 203.291 90.2646 203.069 90.4861C202.848 90.7076 202.69 90.3139 202.719 89.6111ZM198.5 64.2251C198.958 64.0402 199.708 64.0402 200.167 64.2251C200.625 64.4101 200.25 64.5614 199.333 64.5614C198.417 64.5614 198.042 64.4101 198.5 64.2251ZM186.27 47.1667L185 45.6667L186.5 46.9367C187.91 48.1301 188.303 48.6667 187.77 48.6667C187.643 48.6667 186.968 47.9917 186.27 47.1667ZM181.248 42.1667C180.419 41.1093 180.443 41.0857 181.5 41.915C182.61 42.7859 182.964 43.3333 182.415 43.3333C182.277 43.3333 181.752 42.8083 181.248 42.1667ZM114.5 28.2251C114.958 28.0402 115.708 28.0402 116.167 28.2251C116.625 28.4101 116.25 28.5614 115.333 28.5614C114.417 28.5614 114.042 28.4101 114.5 28.2251ZM146.5 28.2251C146.958 28.0402 147.708 28.0402 148.167 28.2251C148.625 28.4101 148.25 28.5614 147.333 28.5614C146.417 28.5614 146.042 28.4101 146.5 28.2251ZM121.513 27.538C122.161 27.369 123.061 27.3801 123.513 27.5627C123.964 27.7453 123.433 27.8836 122.333 27.87C121.233 27.8564 120.864 27.707 121.513 27.538ZM139.513 27.538C140.161 27.369 141.061 27.3801 141.513 27.5627C141.964 27.7453 141.433 27.8836 140.333 27.87C139.233 27.8564 138.864 27.707 139.513 27.538ZM116.667 19.1401C116.667 17.7395 119.514 13.2991 121.471 11.6495C124.578 9.02946 127.419 7.99776 131.479 8.01464C137.519 8.03975 143.287 11.8538 145.572 17.3333L146.545 19.6667H131.606C123.389 19.6667 116.667 19.4297 116.667 19.1401Z" fill="#E48D12"/>
                                                                        <path id="path849" d="M160.667 251C161.528 250.083 162.382 249.333 162.566 249.333C162.749 249.333 162.194 250.083 161.333 251C160.472 251.917 159.618 252.667 159.434 252.667C159.251 252.667 159.806 251.917 160.667 251ZM10.0526 202.278C10.0846 201.501 10.2426 201.343 10.4554 201.875C10.648 202.356 10.6243 202.931 10.4028 203.153C10.1813 203.374 10.0237 202.981 10.0526 202.278V202.278ZM30.5417 179.545C31.0229 179.352 31.5979 179.376 31.8195 179.597C32.041 179.819 31.6472 179.976 30.9445 179.947C30.1678 179.915 30.0099 179.757 30.5417 179.545V179.545ZM197.089 156.977C180.714 152.867 169.838 137.026 172.547 121.229C174.766 108.29 184.45 98.0779 197.395 95.0265C219.804 89.7445 241.213 108.848 237.453 130.771C235.648 141.3 229.336 149.646 219.572 154.414C216.691 155.821 214.183 157.129 214 157.32C213.202 158.15 200.758 157.898 197.089 156.977V156.977ZM211.722 141.965C213.121 141.101 214.616 139.206 215.786 136.816C217.398 133.521 217.636 132.248 217.636 126.94C217.636 121.487 217.428 120.442 215.652 116.995C211.26 108.471 202.264 108.475 198 117.002C196.54 119.921 196.333 121.2 196.333 127.334C196.333 133.229 196.56 134.755 197.768 137.001C199.254 139.761 201.596 142.228 203.333 142.863C205.618 143.698 209.611 143.271 211.722 141.966V141.965ZM203.683 138.41C201.413 136.141 200.48 131.9 200.794 125.291C201.104 118.764 202.541 115.486 205.527 114.491C207.966 113.678 210.421 115.262 211.818 118.552C213.106 121.586 213.262 131.32 212.078 134.823C211.156 137.553 208.541 140 206.546 140C205.846 140 204.557 139.284 203.683 138.41V138.41ZM50.2521 128C50.2521 123.783 50.3604 122.058 50.4927 124.167C50.625 126.275 50.625 129.725 50.4927 131.833C50.3604 133.942 50.2521 132.217 50.2521 128V128ZM50.7193 100.278C50.7513 99.5011 50.9093 99.3432 51.1221 99.875C51.3147 100.356 51.291 100.931 51.0695 101.153C50.8479 101.374 50.6904 100.981 50.7193 100.278ZM229.463 82.3333C229.477 81.2333 229.626 80.864 229.795 81.5127C229.964 82.1613 229.953 83.0613 229.771 83.5127C229.588 83.964 229.45 83.4333 229.463 82.3333V82.3333ZM40.8348 81C40.8422 79.5333 40.9787 79.0118 41.1382 79.8411C41.2976 80.6704 41.2916 81.8704 41.1247 82.5078C40.9579 83.1452 40.8274 82.4667 40.8348 81ZM221.386 75.6111C221.418 74.8345 221.576 74.6765 221.789 75.2083C221.981 75.6896 221.958 76.2646 221.736 76.4861C221.515 76.7076 221.357 76.3139 221.386 75.6111H221.386ZM41.386 70.9445C41.418 70.1678 41.5759 70.0098 41.7887 70.5417C41.9813 71.0229 41.9576 71.5979 41.7361 71.8195C41.5146 72.041 41.357 71.6472 41.386 70.9445H41.386ZM203.875 70.8779C204.356 70.6853 204.931 70.709 205.153 70.9305C205.374 71.152 204.981 71.3096 204.278 71.2807C203.501 71.2487 203.343 71.0907 203.875 70.8779V70.8779ZM228.053 66.9444C228.085 66.1678 228.243 66.0098 228.455 66.5417C228.648 67.0229 228.624 67.5979 228.403 67.8194C228.181 68.041 228.024 67.6472 228.053 66.9444H228.053ZM23.5015 59C23.5089 57.5333 23.6454 57.0118 23.8048 57.8411C23.9643 58.6704 23.9583 59.8704 23.7914 60.5078C23.6245 61.1452 23.4941 60.4667 23.5015 59ZM246.053 52.9444C246.085 52.1678 246.243 52.0098 246.455 52.5417C246.648 53.0229 246.624 53.5979 246.403 53.8194C246.181 54.041 246.024 53.6472 246.053 52.9444H246.053ZM202.582 31.5C201.752 30.4426 201.776 30.419 202.833 31.2483C203.944 32.1192 204.297 32.6667 203.748 32.6667C203.61 32.6667 203.085 32.1417 202.582 31.5V31.5ZM33.3333 31.0816C33.3333 30.9432 33.8583 30.4182 34.5 29.915C35.5574 29.0857 35.581 29.1093 34.7517 30.1667C33.8808 31.2772 33.3333 31.6303 33.3333 31.0816V31.0816ZM52.6667 27.7914C52.6667 27.6767 53.6417 26.7017 54.8333 25.6247L57 23.6667L55.0419 25.8333C53.2168 27.853 52.6667 28.3064 52.6667 27.7914V27.7914ZM205.248 23.5C204.419 22.4426 204.443 22.419 205.5 23.2483C206.61 24.1192 206.964 24.6667 206.415 24.6667C206.277 24.6667 205.752 24.1417 205.248 23.5ZM36.5417 18.8779C37.0229 18.6853 37.5979 18.709 37.8195 18.9306C38.041 19.1521 37.6472 19.3096 36.9445 19.2807C36.1678 19.2487 36.0099 19.0907 36.5417 18.8779V18.8779ZM225.208 18.8779C225.69 18.6853 226.265 18.709 226.486 18.9306C226.708 19.1521 226.314 19.3096 225.611 19.2807C224.834 19.2487 224.677 19.0907 225.208 18.8779V18.8779ZM115 6.66666C115.664 5.93333 116.357 5.33333 116.54 5.33333C116.723 5.33333 116.33 5.93333 115.667 6.66666C115.003 7.4 114.31 8 114.127 8C113.943 8 114.336 7.4 115 6.66666ZM128.542 0.211255C129.023 0.0186742 129.598 0.0423584 129.819 0.263886C130.041 0.485414 129.647 0.64298 128.944 0.614032C128.168 0.582043 128.01 0.424072 128.542 0.211255V0.211255Z" fill="#1155AD"/>
                                                                        <path id="path847" d="M123.52 262.34C111.288 260.122 99.6641 251.263 94.2057 240C92.6953 236.883 91.0761 232.308 90.6075 229.833L89.7554 225.333H81.3594C71.8449 225.333 70 224.684 70 221.333C70 217.085 64.8286 217.335 152.982 217.319C229.17 217.305 233.128 217.245 235.667 216.081C245.517 211.562 247.704 198.924 239.915 191.534C235.158 187.021 243.202 187.333 131.855 187.337C68.4761 187.339 30.133 187.582 28.6667 187.99C27.3833 188.347 25.1996 189.574 23.814 190.717C16.6894 196.594 16.5216 207.824 23.4708 213.684C27.5352 217.111 28.818 217.333 44.5196 217.333C58.2532 217.333 59.165 217.411 60.541 218.693C62.4265 220.449 62.383 221.678 60.3636 223.697C58.7387 225.322 58.6371 225.333 45.788 225.333C38.6713 225.333 31.2648 225.033 29.3291 224.666C18.573 222.626 11.3231 214.283 10.7924 203.333C10.177 190.637 19.1695 180.912 32.7009 179.64C40.6289 178.894 44.0545 176.237 46.8446 168.667C49.2665 162.096 49.9106 154.123 50.6686 121.333C51.1462 100.674 51.5653 93.1327 52.6139 86.3333C58.1968 50.133 73.3247 31.0853 102.904 23.0122L108.259 21.551L109.012 18.2755C110.526 11.691 115.159 5.72521 121.036 2.78937C127.347 -0.36259 136.039 -0.362524 142.086 2.78953C147.56 5.64254 154 14.1735 154 18.5709C154 20.7542 154.739 22 156.033 22C158.735 22 171.957 26.894 177.188 29.8302C180.289 31.5708 185.094 35.1274 188.034 37.8591C194.724 44.0738 203.333 56.8357 203.333 60.5368C203.333 62.4263 201.069 64.1325 198.893 63.8833C197.292 63.7001 196.579 62.8786 194.262 58.5526C190.796 52.0795 187.593 47.7127 183.533 43.9273C170.56 31.8328 152.382 26.6142 126.365 27.5157C84.298 28.9732 63.968 49.3335 59.3141 94.6667C58.9188 98.5167 58.3248 113.817 57.9941 128.667C57.2714 161.114 56.307 168.441 51.6978 176.5L50.0773 179.333H131.4H212.723L211.068 176.5C209.424 173.687 207.152 166.202 206.333 160.902L205.906 158.138L209.256 157.677C211.098 157.424 212.884 157.389 213.225 157.6C213.565 157.81 214.06 159.706 214.323 161.813C215.379 170.267 219.708 177.363 224.573 178.614C225.908 178.958 229.171 179.531 231.823 179.888C237.749 180.687 241.82 182.59 245.513 186.29C258.615 199.414 251.736 221.177 233.386 224.657C231.321 225.048 217.812 225.333 201.328 225.333H172.838L172.389 228.723C171.01 239.114 163.8 249.936 154 256.32C148.71 259.767 143.86 261.615 137.539 262.592C131.691 263.496 129.698 263.46 123.52 262.34V262.34ZM141.478 254.01C149.26 251.606 156.757 245.633 160.93 238.512C162.432 235.95 165.333 227.596 165.333 225.835C165.333 225.559 150.072 225.333 131.419 225.333H97.5055L98.0827 228.423C99.0206 233.443 103.033 240.966 106.854 244.872C115.853 254.066 129.572 257.687 141.478 254.01V254.01ZM145.572 17.3333C143.287 11.8538 137.519 8.03976 131.479 8.01465C127.419 7.99777 124.578 9.02947 121.471 11.6495C119.514 13.2991 116.667 17.7395 116.667 19.1401C116.667 19.4297 123.389 19.6667 131.606 19.6667H146.545L145.572 17.3333ZM206.5 94.1767C203.759 93.9605 203.334 93.7302 203.335 92.4635C203.336 91.6586 202.673 87.0576 201.86 82.2391C200.156 72.1286 200.414 71.1146 204.61 71.4663C206.737 71.6447 207.094 71.9537 207.853 74.278C208.653 76.7309 210.04 84.3337 210.994 91.5C211.314 93.91 211.206 94.638 210.541 94.5465C210.06 94.4804 208.242 94.314 206.5 94.1767V94.1767ZM34.4367 86.1142C31.0896 82.4157 35.6565 56.6043 41.829 44.3333C48.34 31.3895 62.8024 16.3863 67.6064 17.592C69.6107 18.095 70.9045 20.2004 70.3272 22.0194C70.0999 22.7357 68.1689 24.6644 66.0361 26.3055C51.2864 37.6552 42.4555 55.8946 41.0074 78C40.5178 85.4738 39.7194 87.3333 37 87.3333C36.197 87.3333 35.0435 86.7847 34.4367 86.1142ZM223.191 86.1667C222.485 85.3559 222.058 82.8649 221.791 78C220.562 55.6268 210.709 35.8569 195.5 25.246C193.28 23.6971 192.667 22.8537 192.667 21.3489C192.667 19.1876 194.175 17.3333 195.933 17.3333C199.273 17.3333 210.434 27.4594 215.498 35.0848C224.046 47.955 228.38 61.3796 229.147 77.3607C229.468 84.0447 229.367 85.2043 228.377 86.194C226.908 87.6638 224.483 87.651 223.191 86.1666V86.1667ZM18.2931 64.4876C17.5819 64.0987 16.758 63.455 16.4622 63.057C15.6034 61.9016 16.5831 51.237 18.0691 45.5634C22.0461 30.3795 35.0001 15.2668 39.8667 20.1333C41.6796 21.9463 40.7143 24.1087 36.0657 28.648C28.7879 35.7545 24.6587 45.5176 23.5818 58.1644C23.3399 61.0049 22.8101 63.5833 22.4043 63.8943C20.9813 64.985 19.5744 65.1881 18.2931 64.4876V64.4876ZM241.626 64.4876C239.73 63.4507 239.355 62.641 239.344 59.5586C239.33 55.9276 237.65 47.2285 236.219 43.3792C234.113 37.7168 231.071 33.0195 226.526 28.4122C224.037 25.8889 222 23.3942 222 22.8684C222 20.63 223.376 19.3333 225.752 19.3333C230.591 19.3333 240.121 31.3869 243.74 42.0855C246.448 50.0902 247.636 62.42 245.833 63.8149C244.323 64.9832 242.938 65.2047 241.626 64.4876V64.4876Z" fill="#050403"/>
                                                                        </g>
                                                                        </g>
                                                                        </g>
                                                                        </svg>
                                                                    <p><b>Nessuna notifica</b></p>`);
                        }
                        $("#loader").hide();
                    }
                },
                error: function(error) {
                    $("#loader").hide();
                    $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                    $("#messageModalContent").html(error.responseText)
                    $("#messageModal").modal("show");
                }
            });
        } else {
            location.hash = "#login";
        }
    }
    if (fragmentId === "profile") {
        cookie_value = getCookie("userid");
        $('#display-username').html(cookie_value.split("|")[0]);
    }
    if (fragmentId === "calendar" || fragmentId === "pickuphistory") {
        scaleCalendar();
    }
}

function loadContent(){
    $("#loader").show();
    var fragmentId = location.hash.substr(1);

    getContent(fragmentId, function (content) {
        $.ajax($('.container').load(content)).done(function() {
            $("#loader").hide();
            window.scrollTo(0, 0);
            footer();
            var fragmentId = location.hash.substr(1);
            if (fragmentId === "startpickup" || fragmentId === "pickup" || fragmentId === "pickuphour" || fragmentId === "pickuphour" || fragmentId === "confirmpickup" || fragmentId === "readyforpickup" || fragmentId === "hospitalinfo" || fragmentId === "profile" || fragmentId === "settings" || fragmentId === "calendar") {
                $("#loader").show();
                cookie_value = getCookie("userid");
                if (cookie_value !== "") {
                    $.ajax({
                        url: '/checkpickup',
                        dataType: 'json',
                        method: 'POST',
                        data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
                        success: function(res) {
                            if (res.redirectToLogin) {
                                location.hash = "#login";
                            } else {
                                if (res.day_for_pickup) {
                                    $('#alert').html("<i class='fas fa-exclamation-circle'></i> Hai 1 terapia da ritirare a breve.");
                                }
                                $("#loader").hide();
                            }
                        },
                        error: function(error) {
                            $("#loader").hide();
                            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                            $("#messageModalContent").html(error.responseText)
                            $("#messageModal").modal("show");
                        }
                    });
                } else {
                    $("#loader").hide();
                    location.hash = "#login";
                }
            }
            if (fragmentId === "home" || fragmentId === "login" || fragmentId === "tutorial") {
                $('.identity').css('visibility', 'hidden');
            } else {
                $('.identity').css('visibility', 'visible');
            }
            if (fragmentId === "menu" || fragmentId === "startpickup" || fragmentId === "pickup" || fragmentId === "pickuphour" || fragmentId === "confirmpickup" || fragmentId === "readyforpickup" || fragmentId === "hospitalinfo" || fragmentId === "profile" || fragmentId === "therapy" || fragmentId === "notifications" || fragmentId === "guide" || fragmentId === "settings" || fragmentId === "calendar" || fragmentId === "pickuphistory" || fragmentId === "notificationhistory" || fragmentId === "examplenotifications" || fragmentId === "exampletherapies") {
                $('.nav').css('visibility', 'visible');
            } else {
                $('.nav').css('visibility', 'hidden');
            }
            $(".calendar path").attr("fill", "#757575");
            $(".pickup path").attr("fill", "#757575");
            $(".notificationhistory path").attr("fill", "#757575");
            $(".profile path").attr("fill", "#757575");
            $(".calendar svg").attr("width", "30px");
            $(".pickup svg").attr("width", "30px");
            $(".notificationhistory svg").attr("width", "30px");
            $(".profile svg").attr("width", "30px");
            $(".calendar").removeClass("active");
            $(".pickup").removeClass("active");
            $(".notificationhistory").removeClass("active");
            $(".profile").removeClass("active");
            if (fragmentId === "calendar" || fragmentId === "pickuphistory") {
                scaleCalendar();
                $(".calendar").addClass("active");
                $(".calendar path").attr("fill", "#004AAD");
                $(".calendar svg").attr("width", "40px");
            }
            if (fragmentId === "startpickup" || fragmentId === "pickup" || fragmentId === "pickuphour" || fragmentId === "confirmpickup" || fragmentId === "pickup" || fragmentId === "readyforpickup" || fragmentId === "hospitalinfo") {
                $(".pickup").addClass("active");
                $(".pickup path").attr("fill", "#004AAD");
                $(".pickup svg").attr("width", "40px");
            }
            if (fragmentId === "notificationhistory") {
                scaleCalendar();
                $(".notificationhistory").addClass("active");
                $(".notificationhistory path").attr("fill", "#004AAD");
                $(".notificationhistory svg").attr("width", "40px");
            }
            if (fragmentId === "settings" || fragmentId === "guide" || fragmentId === "profile") {
                $(".profile").addClass("active");
                $(".profile path").attr("fill", "#004AAD");
                $(".profile svg").attr("width", "50px");
            }

            if (fragmentId === "home" || fragmentId === "login") {
                document.title = 'Accesso - Unlock490';

            }
            if (fragmentId === "tutorial") {
                document.title = 'Tutorial - Unlock490';
            }
            if (fragmentId === "signup") {
                document.title = 'Iscrizione - Unlock490';

                $("#signupForm").validate({
                    rules: {
                        username: {
                            required: true
                        },
                        password: {
                            required: true,
                            minlength: 8
                        },
                        verify: {
                            required: true,
                            equalTo: "#password"
                        }
                    },
                    messages: {
                        username: {
                            required: "Inserisci il tuo username"
                        },
                        password: {
                            required: "Inserisci una password",
                            minlength: "Inserisci una password di almeno 8 caratteri"
                        },
                        verify: {
                            required: "Ripeti la password",
                            equalTo: "Le password non coincidono"
                        }
                    }
                });
            }
            if (fragmentId === "emailphonesignup") {
                document.title = 'Dati aggiuntivi - Unlock490';

                $("#emailphonesignupForm").validate({
                    rules: {
                        email: {
                            required: true,
                            email: true
                        },
                        phone: {
                            required: true,
                            phone: true
                        }
                    },
                    messages: {
                        email: {
                            required: "Inserisci il tuo indirizzo email",
                            email: "Inserisci l'indirizzo email nel formato corretto"
                        },
                        phone: {
                            required: "Inserisci il tuo numero di cellulare",
                            phone: "Inserisci un numero di cellulare valido"
                        }
                    }
                });

                window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier("emailphonesignupButton", {
                    'size': 'invisible',
                    'callback': function (recaptchaToken) {
                    email = document.getElementById('email').value;
                    $.ajax({
                        url: '/emailphonesignup',
                        dataType: 'json',
                        method: 'POST',
                        data: {username: username, phoneNumber: document.getElementById('phone').value, email: email, recaptchaToken: recaptchaToken},
                        beforeSend: function() {
                            if(!$("#emailphonesignupForm").valid()) {
                                return false;
                            }
                            $("#loader").show();
                        },
                        success: function(res) {
                            email = res.email;
                            phone = res.phone;
                            $("#loader").hide();
                            location.hash = "#verifyemail";
                            return false;
                        },
                        error: function(error) {
                            $("#loader").hide();
                            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                            $("#messageModalContent").html(error.responseText)
                            $("#messageModal").modal("show");
                        }
                    });
                  }
                });

                // render the rapchaVerifier. 
                window.recaptchaVerifier.render().then(function (widgetId) {
                  window.recaptchaWidgetId = widgetId;
                });
            }
            if (fragmentId === "verifyemail") {
                document.title = 'Verifica email - Unlock490';

                $("#email-awaiting-activation").html(email);
            }
            if (fragmentId === "verifyphone") {
                document.title = 'Verifica cellulare - Unlock490';

                $("#phone-awaiting-activation").html(phone);
            }
            if (fragmentId === "success") {
                document.title = 'Iscrizione terminata - Unlock490';
            }
            if (fragmentId === "newpassword") {
                document.title = 'Reimposta password - Unlock490';

                $("#recoveryForm").validate({
                    rules: {
                        username: {
                            required: true
                        },
                        cf: {
                            required: true
                        },
                        phone: {
                            required: true,
                            phone: true
                        }
                    },
                    messages: {
                        username: {
                            required: "Inserisci il tuo username"
                        },
                        cf: {
                            required: "Inserisci il tuo codice fiscale"
                        },
                        phone: {
                            required: "Inserisci il tuo numero di cellulare",
                            phone: "Inserisci un numero di cellulare valido"
                        }
                    }
                });
            }
            if (fragmentId === "verifyemailforrecovery") {
                document.title = 'Reimposta password - Unlock490';

                $("#email-awaiting-verification").html(email);
            }
            if (fragmentId === "verifyphoneforrecovery") {
                document.title = 'Reimposta password - Unlock490';

                $("#phone-awaiting-verification").html(phone);
            }
            if (fragmentId === "choosenewpassword") {
                document.title = 'Reimposta password - Unlock490';

                $("#choosepasswordForm").validate({
                    rules: {
                        password: {
                            required: true,
                            minlength: 8
                        },
                        password2: {
                            required: true,
                            equalTo: "#password"
                        }
                    },
                    messages: {
                        password: {
                            required: "Inserisci una password",
                            minlength: "Inserisci una password di almeno 8 caratteri"
                        },
                        password2: {
                            required: "Ripeti la password",
                            equalTo: "Le password non coincidono"
                        }
                    }
                });
            }
            if (fragmentId === "recoverysuccess") {
                document.title = 'Reimposta password - Unlock490';
            }
            if (fragmentId === "pickup") {
                document.title = 'Ritiro - Unlock490';
            }
            if (fragmentId === "pickuphour") {
                document.title = 'Ritiro - Unlock490';

                $('#day-for-pickup').html(convertDate(day_for_pickup));
            }
            if (fragmentId === "confirmpickup") {

                document.title = 'Ritiro - Unlock490';

                $('#day-for-pickup').html(convertDate(day_for_pickup));
                $('#hour-for-pickup').html(convertHour(hour_for_pickup));
            }
            if (fragmentId === "readyforpickup") {
                document.title = 'Ritiro - Unlock490';

                $("#loader").show();
                cookie_value = getCookie("userid");
                if (cookie_value !== "") {
                    $.ajax({
                        url: '/checkpickup',
                        dataType: 'json',
                        method: 'POST',
                        data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
                        success: function(res) {
                            if (res.redirectToLogin) {
                                location.hash = "#login";
                            } else {
                                if (res.day_for_pickup) {
                                    $('#day-for-pickup').html(convertDate(res.day_for_pickup));
                                    $('#hour-for-pickup').html(convertHour(res.hour_for_pickup));
                                    $('#alert').html("<i class='fas fa-exclamation-circle'></i> Hai 1 terapia da ritirare a breve.");
                                }
                                $("#loader").hide();
                            }
                        },
                        error: function(error) {
                            $("#loader").hide();
                            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                            $("#messageModalContent").html(error.responseText)
                            $("#messageModal").modal("show");
                        }
                    });
                } else {
                    location.hash = "#login";
                }
            }
            if (fragmentId === "pickuphistory") {
                document.title = 'Cronologia ritiri - Unlock490';

                $("#alert").css("display", "block");

                $("#loader").show();
                cookie_value = getCookie("userid");
                if (cookie_value !== "") {
                    $.ajax({
                        url: '/checkpickup',
                        dataType: 'json',
                        method: 'POST',
                        data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
                        success: function(res) {
                            if (res.redirectToLogin) {
                                location.hash = "#login";
                            } else {
                                if (res.day_for_pickup) {
                                    $('#day-for-pickup').html(convertDate(res.day_for_pickup));
                                    $('#hour-for-pickup').html(convertHour(res.hour_for_pickup));
                                    $('#alert').html("<i class='fas fa-exclamation-circle'></i> Hai 1 terapia da ritirare a breve.");
                                }
                                $("#loader").hide();
                            }
                        },
                        error: function(error) {
                            $("#loader").hide();
                            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                            $("#messageModalContent").html(error.responseText)
                            $("#messageModal").modal("show");
                        }
                    });
                } else {
                    location.hash = "#login";
                }
            }
            if (fragmentId === "notificationhistory") {
                document.title = 'Cronologia notifiche - Unlock490';
            }
            if (fragmentId === "hospitalinfo") {
                document.title = 'Informazioni sul centro ospedaliero - Unlock490';
            }
            if (fragmentId === "profile") {
                document.title = 'Profilo - Unlock490';

                cookie_value = getCookie("userid");
                $('#display-username').html(cookie_value.split("|")[0]);
            }
            if (fragmentId === "guide") {
                document.title = 'Guida - Unlock490';
            }
            if (fragmentId === "settings") {
                document.title = 'Impostazioni - Unlock490';
            }
            if (fragmentId === "calendar") {
                document.title = 'Calendario - Unlock490';
            }
        });
    });
}

if(!location.hash) {
  location.hash = "#home";
}

function getDayForPickup() {
    if (location.hash.substr(1) === "pickup") {
        var day_for_pickup = $(".available-day").not($(".hidden-day")).attr("id");
    }
}

loadContent();
window.addEventListener("hashchange", loadContent);
window.addEventListener("hashchange", getDayForPickup);

$(document).on("click touch", "#signup", function() {
    location.hash = "#signup";
    return false;
});

$(document).on("click touch", "#signupButton", function() {
    username = $("#username").val();
    $.ajax({
        url: '/signup',
        dataType: 'json',
        method: 'POST',
        data: {username: username, password: $("#password").val(), verify: $("#verify").val()},
        beforeSend: function() {
            if(!$("#signupForm").valid()) {
                return false;
            }
            $("#loader").show();
        },
        success: function(res) {
            $("#loader").hide();
            location.hash = "#emailphonesignup";
            return false;
        },
        error: function(error) {
            $("#loader").hide();
            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
            $("#messageModalContent").html(error.responseText)
            $("#messageModal").modal("show");
        }
    });
});

$(document).on("click touch", "#emailphonesignupButton", function() {
    location.hash = "#verifyemail";
    return false;
});

$(document).on("click touch", "#verifyemailButton", function() {
    $("#loader").show();
    $.ajax({
        url: '/verifyemail',
        dataType: 'json',
        method: 'POST',
        data: {username: username, email: email, email_code_input: document.getElementById('emailcode').value},
        success: function(res) {
            $("#loader").hide();
            location.hash = "#verifyphone";
        },
        error: function(error) {
            $("#loader").hide();
            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
            $("#messageModalContent").html(error.responseText)
            $("#messageModal").modal("show");
        }
    });
    return false;
});

$(document).on("click touch", "#verifyphoneButton", function() {
    $("#loader").show();
    $.ajax({
        url: '/verifyphone',
        dataType: 'json',
        method: 'POST',
        data: {username: username, phone: phone, sms_code_input: document.getElementById('smscode').value},
        success: function(res) {
            $("#loader").hide();
            location.hash = "#success";
        },
        error: function(error) {
            $("#loader").hide();
            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
            $("#messageModalContent").html(error.responseText)
            $("#messageModal").modal("show");
        }
    });
    return false;
});

$(document).on("click touch", "#loginButton", function() {

    $.ajax({
        url: '/login',
        dataType: 'json',
        method: 'POST',
        data: {username: document.getElementById('username').value, password: document.getElementById('password').value},
        success: function(res) {
            $("#loader").show();
            cookie_value = getCookie("userid");
            if (cookie_value !== "") {
                $.ajax({
                    url: '/checkpickup',
                    dataType: 'json',
                    method: 'POST',
                    data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
                    success: function(res) {
                        if (res.redirectToLogin) {
                            location.hash = "#login";
                        } else {
                            if (res.day_for_pickup) {
                                $("#loader").hide();
                                location.hash = "#readyforpickup";
                            } else {
                                $("#loader").hide();
                                location.hash = "#startpickup";
                            }
                        }
                    },
                    error: function(error) {
                        $("#loader").hide();
                        $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                        $("#messageModalContent").html(error.responseText)
                        $("#messageModal").modal("show");
                    }
                });
            } else {
                location.hash = "#login";
            }
        },
        error: function(error) {
            $("#loader").hide();
            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
            $("#messageModalContent").html(error.responseText)
            $("#messageModal").modal("show");
        }
    });

    return false;
});

$(document).on("click touch", "#startButton", function() {
    location.hash = "#pickup";
    return false;
});

$(document).on("click touch", "#newpassword", function() {
    location.hash = "#newpassword";
    return false;
});

$(document).on("click touch", "#recoveryButton", function() {
    $.ajax({
        url: '/newpassword',
        dataType: 'json',
        method: 'POST',
        data: {username: document.getElementById('username').value, cf: document.getElementById('cf').value, phone: document.getElementById('phone').value},
        beforeSend: function() {
            if(!$("#recoveryForm").valid()) {
                return false;
            }
            $("#loader").show();
        },
        success: function(res) {
            username = document.getElementById('username').value;
            phone = document.getElementById('phone').value;
            email = res.email;
            $("#loader").hide();
            location.hash = "#verifyemailforrecovery";
        },
        error: function(error) {
            $("#loader").hide();
            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
            $("#messageModalContent").html(error.responseText)
            $("#messageModal").modal("show");
        }
    });
    return false;
});

$(document).on("click touch", "#verifyemailforrecoveryButton", function() {
    $("#loader").show();
    $.ajax({
        url: '/verifyemailforrecovery',
        dataType: 'json',
        method: 'POST',
        data: {username: username, email_code_input: document.getElementById('emailcode').value},
        success: function(res) {
            $("#loader").hide();
            location.hash = "#verifyphoneforrecovery";
        },
        error: function(error) {
            $("#loader").hide();
            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
            $("#messageModalContent").html(error.responseText)
            $("#messageModal").modal("show");
        }
    });
    return false;
});

$(document).on("click touch", "#verifyphoneforrecoveryButton", function() {
    $("#loader").show();
    $.ajax({
        url: '/verifyphoneforrecovery',
        dataType: 'json',
        method: 'POST',
        data: {username: username, sms_code_input: document.getElementById('smscode').value},
        success: function(res) {
            $("#loader").hide();
            location.hash = "#choosenewpassword";
        },
        error: function(error) {
            $("#loader").hide();
            $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
            $("#messageModalContent").html(error.responseText)
            $("#messageModal").modal("show");
        }
    });
    return false;
});

$(document).on("click touch", "#choosepasswordButton", function() {
    $("#loader").show();
    cookie_value = getCookie("userid");
    if (cookie_value !== "") {
        $.ajax({
            url: '/choosenewpassword',
            dataType: 'json',
            method: 'POST',
            data: {username: getCookie("userid").split("|")[0], oldpassword: getCookie("userid").split("|")[1], password: document.getElementById('password').value, verify: document.getElementById('password2').value},
            beforeSend: function() {
                if(!$("#choosepasswordForm").valid()) {
                    return false;
                }
                $("#loader").show();
            },
            success: function(res) {
                $("#loader").hide();
                location.hash = "#recoverysuccess";
            },
            error: function(error) {
                $("#loader").hide();
                $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                $("#messageModalContent").html(error.responseText)
                $("#messageModal").modal("show");
            }
        });
    } else {
        $.ajax({
            url: '/choosenewpassword',
            dataType: 'json',
            method: 'POST',
            data: {username: username, password: document.getElementById('password').value, verify: document.getElementById('password2').value},
            beforeSend: function() {
                if(!$("#choosepasswordForm").valid()) {
                    return false;
                }
                $("#loader").show();
            },
            success: function(res) {
                $("#loader").hide();
                location.hash = "#recoverysuccess";
            },
            error: function(error) {
                $("#loader").hide();
                $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                $("#messageModalContent").html(error.responseText)
                $("#messageModal").modal("show");
            }
        });
    }
    return false;
});

$(document).on("click touch", "#toLogin", function() {
    location.hash = "#login";
    return false;
});

// $(document).on("click touch", "#profile", function() {
//     location.hash = "#profile";
//     return false;
// });

$(document).on("click touch", ".pickup", function() {
    $("#loader").show();
    cookie_value = getCookie("userid");
    if (cookie_value !== "") {
        $.ajax({
            url: '/checkpickup',
            dataType: 'json',
            method: 'POST',
            data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
            success: function(res) {
                if (res.redirectToLogin) {
                    location.hash = "#login";
                } else {
                    if (res.day_for_pickup) {
                        $("#loader").hide();
                        location.hash = "#readyforpickup";
                    } else {
                        $("#loader").hide();
                        location.hash = "#startpickup";
                    }
                }
            },
            error: function(error) {
                $("#loader").hide();
                $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                $("#messageModalContent").html(error.responseText)
                $("#messageModal").modal("show");
            }
        });
    } else {
        location.hash = "#login";
    }
    return false;
});

$(document).on("click touch", "#guide", function() {
    location.hash = "#guide";
    return false;
});

// $(document).on("click touch", "#settings", function() {
//     location.hash = "#settings";
//     return false;
// });
    // $.ajax({
    //     url: '/emailphonesignup',
    //     type: 'post',
    //     dataType: 'json',
    //     data: $('form#signupForm').serialize(),
    //     success: function(data) {
    //                // ... do something with the data...
    //              }
    // });

$(document).on("click touch", "#filterAllDays", function() {
    $('#filterAllDays').addClass('active');
    $('#filterCurrentWeek').removeClass('active');
    $('#filterNextWeek').removeClass('active');
    $("#20210204").show();
    $("#20210205").show();
    $("#20210208").show();
    $("#20210211").show();
    $("#20210212").show();
    $("#20210213").show();
});

$(document).on("click touch", "#filterCurrentWeek", function() {
    $('#filterAllDays').removeClass('active');
    $('#filterCurrentWeek').addClass('active');
    $('#filterNextWeek').removeClass('active');
    $("#20210204").show();
    $("#20210205").show();
    $("#20210208").show();
    $("#20210211").hide();
    $("#20210212").hide();
    $("#20210213").hide();
});

$(document).on("click touch", "#filterNextWeek", function() {
    $('#filterAllDays').removeClass('active');
    $('#filterCurrentWeek').removeClass('active');
    $('#filterNextWeek').addClass('active');
    $("#20210204").hide();
    $("#20210205").hide();
    $("#20210208").hide();
    $("#20210211").show();
    $("#20210212").show();
    $("#20210213").show();
});

// $(document).on("click touch", ".available-day", function() {
//     day_for_pickup = $(this).attr("id");
//     location.hash = "#pickuphour";
//     return false;
// });

$(document).on("click touch", "#filterAllHours", function() {
    $('#filterAllHours').addClass('active');
    $('#filterAM').removeClass('active');
    $('#filterPM').removeClass('active');
    $("#0730").show();
    $("#0830").show();
    $("#0930").show();
    $("#1030").show();
    $("#1130").show();
    $("#1230").show();
    $("#1330").show();
    $("#1430").show();
    $("#1530").show();
    $("#1630").show();
    $("#1730").show();
});

$(document).on("click touch", "#filterAM", function() {
    $('#filterAllHours').removeClass('active');
    $('#filterAM').addClass('active');
    $('#filterPM').removeClass('active');
    $("#0730").show();
    $("#0830").show();
    $("#0930").show();
    $("#1030").show();
    $("#1130").show();
    $("#1230").show();
    $("#1330").hide();
    $("#1430").hide();
    $("#1530").hide();
    $("#1630").hide();
    $("#1730").hide();
});

$(document).on("click touch", "#filterPM", function() {
    $('#filterAllHours').removeClass('active');
    $('#filterAM').removeClass('active');
    $('#filterPM').addClass('active');
    $("#0730").hide();
    $("#0830").hide();
    $("#0930").hide();
    $("#1030").hide();
    $("#1130").hide();
    $("#1230").hide();
    $("#1330").show();
    $("#1430").show();
    $("#1530").show();
    $("#1630").show();
    $("#1730").show();
});

$(document).on("click touch", ".available-hour", function() {
    var available_hour = $(this);
    function function1(element) {
        window.day_for_pickup = $(".available-day").not($(".hidden-day")).attr("id");
        window.hour_for_pickup = element.attr("id");
    };
    function function2() {
        location.hash = "#confirmpickup";
    };
    $.when(function1(available_hour)).then(function2());
    return false;
});

// $(document).on("click touch", "#startButton", function() {
//     $("#loader").show();
//     cookie_value = getCookie("userid");
//     if (cookie_value !== "") {
//         $.ajax({
//             url: '/confirmpickup',
//             dataType: 'json',
//             method: 'POST',
//             data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1], day_for_pickup: day_for_pickup, hour_for_pickup: hour_for_pickup},
//             success: function(res) {
//                 $("#loader").hide();
//                 if (!res.redirectToLogin) {
//                     location.hash = "#readyforpickup";
//                 } else {
//                     location.hash = "#login"
//                 }
//             },
//             error: function(error) {
//                 $("#loader").hide();
//                 $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
//                 $("#messageModalContent").html(error.responseText)
//                 $("#messageModal").modal("show");
//             }
//         });
//     } else {
//         location.hash = "#login";
//     }
//     return false;
// });

$(document).on("click touch", "#confirmpickupButton", function() {
    $("#loader").show();
    cookie_value = getCookie("userid");
    if (cookie_value !== "") {
        $.ajax({
            url: '/confirmpickup',
            dataType: 'json',
            method: 'POST',
            data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1], day_for_pickup: day_for_pickup, hour_for_pickup: hour_for_pickup},
            success: function(res) {
                $("#loader").hide();
                if (!res.redirectToLogin) {
                    location.hash = "#readyforpickup";
                } else {
                    location.hash = "#login"
                }
            },
            error: function(error) {
                $("#loader").hide();
                $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                $("#messageModalContent").html(error.responseText)
                $("#messageModal").modal("show");
            }
        });
    } else {
        location.hash = "#login";
    }
    return false;
});

$(document).on("click touch", "#modifypickupButton", function() {
    location.hash = "#pickup";
    return false;
});

$(document).on("click touch", "#undopickup", function() {
    $("#messageModal").modal("hide");
    $("#loader").show();
    cookie_value = getCookie("userid");
    if (cookie_value !== "") {
        $.ajax({
            url: '/undopickup',
            dataType: 'json',
            method: 'POST',
            data: {username: cookie_value.split("|")[0], password: cookie_value.split("|")[1]},
            success: function(res) {
                $("#loader").hide();
                if (!res.redirectToLogin) {
                    location.hash = "#startpickup";
                } else {
                    location.hash = "#login"
                }
            },
            error: function(error) {
                $("#loader").hide();
                $("#messageModalContent").removeClass("alert-success").addClass("alert-danger");
                $("#messageModalContent").html(error.responseText)
                $("#messageModal").modal("show");
            }
        });
    } else {
        location.hash = "#login";
    }
    return false;
});

$(document).on("click touch", "#pickuphistoryButton", function() {
    location.hash = "#pickuphistory"
    return false;
});

$(document).on("click touch", "#notificationhistoryButton", function() {
    location.hash = "#notificationhistory"
    return false;
});

$(document).on("click touch", "#skipButton", function() {
    window.history.go(-1);
    return false;
});

$(document).on("click touch", "#infoButton", function() {
    location.hash = "#hospitalinfo";
    return false;
});

$(document).on("click touch", ".panel-title1", function() {
    if (rotated1) {
        $(".panel-title1 a .fa-angle-down").css({"-webkit-transform":"rotate(0deg)","-moz-transform":"rotate(0deg)","-ms-transform":"rotate(0deg)","-o-transform":"rotate(0deg)","transform":"rotate(0deg)"});
        rotated1 = false;
    } else {
        $(".panel-title1 a .fa-angle-down").css({"-webkit-transform":"rotate(180deg)","-moz-transform":"rotate(180deg)","-ms-transform":"rotate(180deg)","-o-transform":"rotate(180deg)","transform":"rotate(180deg)"});
        rotated1 = true;
    }
});

$(document).on("click touch", ".panel-title2", function() {
    if (rotated2) {
        $(".panel-title2 a .fa-angle-down").css({"-webkit-transform":"rotate(0deg)","-moz-transform":"rotate(0deg)","-ms-transform":"rotate(0deg)","-o-transform":"rotate(0deg)","transform":"rotate(0deg)"});
        rotated2 = false;
    } else {
        $(".panel-title2 a .fa-angle-down").css({"-webkit-transform":"rotate(180deg)","-moz-transform":"rotate(180deg)","-ms-transform":"rotate(180deg)","-o-transform":"rotate(180deg)","transform":"rotate(180deg)"});
        rotated2 = true;
    }
});

$(document).on("click touch", ".panel-title3", function() {
    if (rotated3) {
        $(".panel-title3 a .fa-angle-down").css({"-webkit-transform":"rotate(0deg)","-moz-transform":"rotate(0deg)","-ms-transform":"rotate(0deg)","-o-transform":"rotate(0deg)","transform":"rotate(0deg)"});
        rotated3 = false;
    } else {
        $(".panel-title3 a .fa-angle-down").css({"-webkit-transform":"rotate(180deg)","-moz-transform":"rotate(180deg)","-ms-transform":"rotate(180deg)","-o-transform":"rotate(180deg)","transform":"rotate(180deg)"});
        rotated3 = true;
    }
});

$(document).on("click touch", "#choosenewpassword", function() {
    location.hash = "#choosenewpassword";
    return false;
});

$(document).on("click touch", ".calendar", function() {
    location.hash = "#calendar";
    return false;
});

$(document).on("click touch", "#logout", function() {
    document.cookie = "userid=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
    location.hash = "#login";
    return false;
});


$(document).on("click touch", ".list-group-item", function() {
    $(this).parent().children().removeClass("active-item");
    $(this).addClass("active-item");
});

$(document).on("click touch", ".fa-caret-left", function() {
    $(".fa-caret-left").css("color","black")
    $(".fa-caret-right").css("color","black");
    var currentDay = $(".available-day").not($(".hidden-day"));
    if (currentDay.index() === 1) {
        $(".fa-caret-left").css("color","#c8c8c8");
        return;
    }
    if (currentDay.index() === 2) {
        $(".fa-caret-left").css("color","#c8c8c8");
    }
    if (!currentDay.is(':first-child')) {
        currentDay.prev().removeClass("hidden-day");
        currentDay.addClass("hidden-day");
    }
});

$(document).on("click touch", ".fa-caret-right", function() {
    $(".fa-caret-right").css("color","black")
    $(".fa-caret-left").css("color","black");
    var currentDay = $(".available-day").not($(".hidden-day"));
    if (currentDay.index() === ($("#horizontal-days").children().length-2)) {
        $(".fa-caret-right").css("color","#c8c8c8");
        return;
    }
    if (currentDay.index() === ($("#horizontal-days").children().length-3)) {
        $(".fa-caret-right").css("color","#c8c8c8");
    }
    if (!currentDay.is(':last-child')) {
        currentDay.next().removeClass("hidden-day");
        currentDay.addClass("hidden-day");
    }
});

$(document).on("click touch", "#undopickuppopup", function() {
    $("#messageModalContent").removeClass("alert-success").addClass("alert-info");
    $("#messageModalContent").html("Sei sicuro di annullare il ritiro?")
    $("#messageModal").modal("show");
});

$(document).on("click touch", "#notificationsettingsButton", function() {
    $("#messageModalContent").removeClass("alert-success");
    $("#messageModalLabel").html("Imposta&nbsp;notifiche");
    $("#messageModalContent").html(`<h5>Push</h5>
                                  <ul class="list-group">
                                    <li class="list-group-item active-item">Attiva</li>
                                    <li class="list-group-item">Disattiva</li>
                                  </ul>
                                  <br>
                                  <h5>Email</h5>
                                  <ul class="list-group">
                                    <li class="list-group-item active-item">Attiva</li>
                                    <li class="list-group-item">Disattiva</li>
                                  </ul>
                                  <br>
                                  <h5>SMS</h5>
                                  <ul class="list-group">
                                    <li class="list-group-item active-item">Attiva</li>
                                    <li class="list-group-item">Disattiva</li>
                                  </ul>`);
    $("#messageModal").modal("show");
});

$(document).on("click touch", "#languageButton", function() {
    $("#messageModalContent").removeClass("alert-success").addClass("alert-info");
    $("#messageModalLabel").html("Lingua");
    $("#messageModalContent").html(`<ul class="list-group">
                                    <li class="list-group-item active-item">Italiano</li>
                                    <li class="list-group-item">Inglese</li>
                                    <li class="list-group-item">Tedesco</li>
                                    <li class="list-group-item">Francese</li>
                                  </ul>`);
    $("#messageModal").modal("show");
});

$(document).on("click touch", "#creditsButton", function() {
    $("#messageModalContent").removeClass("alert-success").addClass("alert-info");
    $("#messageModalLabel").html("Credits");
    $("#messageModalContent").html(`<p>Web app creata dal team1 per il Codemotion <a href="https://events.codemotion.com/hackathons/devs-for-health-hiv/home/">Devs for Health in HIV</a> hackathon 2020.</p><p>La realizzazione di Unlock 4/90 Ã¨ stata possibile grazie a un grant incondizionato di Gilead Sciences</p><p>Icone realizzate da <a href="http://www.freepik.com/" title="Freepik">Freepik</a>, <a href="https://www.flaticon.com/free-icon/vitamin_3047656" title="Linector">Linector</a>, <a href="https://www.flaticon.com/authors/good-ware" title="Good Ware">Good Ware</a> e <a href="https://www.flaticon.com/authors/xnimrodx" title="xnimrodx">xnimrodx</a> su <a href="https://www.flaticon.com/" title="Flaticon"> www.flaticon.com</a>.</p>`);
    $("#messageModal").modal("show");
});